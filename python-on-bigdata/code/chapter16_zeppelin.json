{"paragraphs":[{"text":"%jdbc(hive)\r\nSELECT * FROM \r\n(SELECT C.ProductName , SUM(Freight) Freight , AVG(B.UnitPrice) UnitPrice,SUM(B.Quantity * B.UnitPrice) Income  \r\nFROM northwind.ORDERS A INNER JOIN northwind.OrderDetails B ON A.OrderID = B.OrderID\r\nINNER JOIN northwind.Products C ON C.ProductID =B.ProductID\r\nGROUP BY  C.ProductName \r\n) A WHERE Income > 20000","user":"anonymous","dateUpdated":"2019-08-18T14:07:52+0000","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":269,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true},"pieChart":{}},"commonSetting":{},"keys":[{"name":"a.productname","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"a.income","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","editorHide":false,"lineNumbers":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"a.productname\ta.freight\ta.unitprice\ta.income\nC?te de Blaye\t4297.929999999999\t228.36666666666665\t73569.2\nCamembert Pierrot\t3696.1800000000007\t29.86086956521739\t23528.0\nGnocchi di nonna Alice\t3459.63\t33.030769230769224\t23157.199999999997\nRaclette Courdavault\t3249.6700000000005\t47.25925925925926\t32626.0\nTarte au sucre\t1603.7500000000002\t42.99999999999998\t20001.4\nThüringer Rostbratwurst\t1664.77\t104.72076923076922\t24851.080000000005\n"}]},"apps":[],"jobName":"paragraph_1566124814549_2014342384","id":"20190818-104014_1870515266","dateCreated":"2019-08-18T10:40:14+0000","dateStarted":"2019-08-18T12:39:52+0000","dateFinished":"2019-08-18T12:41:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16374"},{"user":"anonymous","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"b.categoryname","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"cnt","index":1,"aggr":"sum"},{"name":"unitsonorder","index":3,"aggr":"sum"},{"name":"unitsinstock","index":2,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566128409161_1826553675","id":"20190818-114009_1895690604","dateCreated":"2019-08-18T11:40:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16625","text":"%jdbc(hive)\r\nSELECT B.CategoryName , count(CategoryName) cnt ,\r\n       AVG(A.UnitsInStock) UnitsInStock ,AVG(UnitsOnOrder) UnitsOnOrder\r\nFROM northwind.Products A INNER JOIN northwind.Categories B\r\nON A.CategoryID = B.CategoryID\r\nGROUP BY B.CategoryName","dateUpdated":"2019-08-18T12:45:55+0000","dateFinished":"2019-08-18T12:41:08+0000","dateStarted":"2019-08-18T12:39:55+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"b.categoryname\tcnt\tunitsinstock\tunitsonorder\nBeverages\t12\t46.583333333333336\t5.0\nCondiments\t12\t42.25\t14.166666666666666\nConfections\t13\t29.692307692307693\t13.846153846153847\nDairy Products\t10\t39.3\t14.0\nGrains/Cereals\t7\t44.0\t12.857142857142858\nMeat/Poultry\t6\t27.5\t0.0\nProduce\t5\t20.0\t4.0\nSeafood\t12\t58.416666666666664\t10.0\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566128419108_-227620702","id":"20190818-114019_950662070","dateCreated":"2019-08-18T11:40:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16690","text":"%spark2.pyspark\nlines = spark.read.text('file:/usr/hdp/spark.txt').rdd.map(lambda r: r[0].lower())","dateUpdated":"2019-08-18T13:26:30+0000","dateFinished":"2019-08-18T13:26:34+0000","dateStarted":"2019-08-18T13:26:31+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.pyspark\nimport operator\ncounts = lines.flatMap(lambda x: x.split(' ')) \\\n              .map(lambda x: (x, 1)) \\\n              .reduceByKey(operator.add) ","user":"anonymous","dateUpdated":"2019-08-18T13:32:11+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566134161479_-1647935806","id":"20190818-131601_1324117086","dateCreated":"2019-08-18T13:16:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19900","dateFinished":"2019-08-18T13:32:11+0000","dateStarted":"2019-08-18T13:32:11+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.pyspark\ndf=counts.toDF() ","user":"anonymous","dateUpdated":"2019-08-18T13:32:42+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566134843167_-37609538","id":"20190818-132723_1821443178","dateCreated":"2019-08-18T13:27:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20103","dateFinished":"2019-08-18T13:32:43+0000","dateStarted":"2019-08-18T13:32:42+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.pyspark\ndata=df.select(df._1.alias('words'),df._2.alias('counts')) ","user":"anonymous","dateUpdated":"2019-08-18T13:33:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566134865410_-1790879627","id":"20190818-132745_922348247","dateCreated":"2019-08-18T13:27:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20168","dateFinished":"2019-08-18T13:33:21+0000","dateStarted":"2019-08-18T13:33:20+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.pyspark\ndata.printSchema()","user":"anonymous","dateUpdated":"2019-08-18T13:33:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566134876411_1534135692","id":"20190818-132756_1279611334","dateCreated":"2019-08-18T13:27:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20227","dateFinished":"2019-08-18T13:33:48+0000","dateStarted":"2019-08-18T13:33:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- words: string (nullable = true)\n |-- counts: long (nullable = true)\n\n"}]}},{"text":"%spark2.pyspark\ndata.createTempView(\"text\") ","user":"anonymous","dateUpdated":"2019-08-18T13:34:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566134913462_394002107","id":"20190818-132833_855261254","dateCreated":"2019-08-18T13:28:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20322","dateFinished":"2019-08-18T13:34:35+0000","dateStarted":"2019-08-18T13:34:35+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%spark2.sql\nselect * from text where counts > 5 \nand words not in ( '','the','of','a','in','and','to','is','as','on','by','for','be','at', \n'that','can','=','//','are','was','an','such','or','with','which','it','its','this','has') \norder by counts desc","user":"anonymous","dateUpdated":"2019-08-18T13:57:17+0000","config":{"colWidth":7,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":364.028,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"words","index":0,"aggr":"sum"}],"groups":[{"name":"words","index":0,"aggr":"sum"}],"values":[{"name":"counts","index":1,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566134952088_938098349","id":"20190818-132912_138526141","dateCreated":"2019-08-18T13:29:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20411","dateFinished":"2019-08-18T13:39:20+0000","dateStarted":"2019-08-18T13:39:19+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"words\tcounts\nspark\t51\napache\t22\ndata\t16\ndistributed\t14\nval\t9\nrdd\t9\nprovides\t7\nmachine\t7\nalgorithms\t6\ngraphx\t6\ncluster\t6\ninterface\t6\nstreaming\t6\n"}]}},{"text":"%spark2.sql\nselect * from text where counts > 5 \nand words not in ( '','the','of','a','in','and','to','is','as','on','by','for','be','at', 'that','can','=','//','are','was','an','such','or','with','which','it','its','this','has')order by counts desc","user":"anonymous","dateUpdated":"2019-08-18T13:49:55+0000","config":{"colWidth":5,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566134979812_-684925754","id":"20190818-132939_746221598","dateCreated":"2019-08-18T13:29:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20503","dateFinished":"2019-08-18T13:48:43+0000","dateStarted":"2019-08-18T13:48:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"words\tcounts\nspark\t51\napache\t22\ndata\t16\ndistributed\t14\nval\t9\nrdd\t9\nprovides\t7\nmachine\t7\nalgorithms\t6\ngraphx\t6\ncluster\t6\ninterface\t6\nstreaming\t6\n"}]}},{"text":"%spark2.pyspark\ndata.show(3)","user":"anonymous","dateUpdated":"2019-08-18T13:40:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566135000977_-1172002537","id":"20190818-133000_1266020038","dateCreated":"2019-08-18T13:30:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20562","dateFinished":"2019-08-18T13:40:07+0000","dateStarted":"2019-08-18T13:40:06+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+------+\n| words|counts|\n+------+------+\n| spark|    51|\n|apache|    22|\n|  data|    16|\n+------+------+\nonly showing top 3 rows\n\n"}]}},{"text":"%spark2.pyspark\n","user":"anonymous","dateUpdated":"2019-08-18T13:40:24+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1566135624150_792424656","id":"20190818-134024_300798492","dateCreated":"2019-08-18T13:40:24+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:21152"}],"name":"test","id":"2EM65YMRU","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}